# VIBE Music Player App

Modern music streaming application built with Next.js 15, TypeScript, and Supabase. Features user authentication, playlist management, song bookmarking, and real-time music playback with a beautiful dark theme interface.

## üöÄ Features

- **üéµ Music Streaming**: Play songs with full player controls (play/pause, skip, volume, progress)
- **üë§ User Authentication**: Email/password and Google OAuth login with NextAuth.js
- **üìù Playlist Management**: Create, edit, and manage personal playlists
- **üîñ Song Bookmarking**: Save favorite songs for quick access
- **üìä Trending System**: View trending songs with real-time statistics
- **üì± Responsive Design**: Mobile-first design with dark/light theme support
- **üîê Route Protection**: Middleware-based authentication and authorization
- **üåê Real-time Updates**: Live data synchronization with Supabase

## üõ† Tech Stack

### Frontend
- **Next.js 15.4.2** - React framework with App Router
- **React 19.1.0** - UI library
- **TypeScript** - Type safety
- **Tailwind CSS 4** - Styling with custom theme variables
- **shadcn/ui** - Component library based on Radix UI
- **Zustand** - State management
- **React Query** - Server state management
- **NextAuth.js** - Authentication

### Backend & Database
- **Supabase** - Backend as a Service (PostgreSQL database)
- **Next.js API Routes** - Server-side API endpoints
- **NextAuth.js** - Authentication middleware
- **bcrypt** - Password hashing

### Additional Libraries
- **React Player** - Audio/video playback
- **Wavesurfer.js** - Audio waveform visualization
- **Lucide React** - Icon library
- **React Hook Form** - Form handling
- **Zod** - Schema validation
- **Sonner** - Toast notifications

## üìã Prerequisites

- Node.js 18+ 
- npm, yarn, or pnpm
- Supabase account
- Google OAuth credentials (optional)

## üîß Installation

1. **Clone the repository**
```bash
git clone <repository-url>
cd music-player-app
```

2. **Install dependencies**
```bash
npm install
# or
yarn install
# or
pnpm install
```

3. **Set up environment variables**

Create a `.env.local` file in the root directory:

```env
# NextAuth Configuration
NEXTAUTH_URL=http://localhost:3000
NEXTAUTH_SECRET=your-nextauth-secret-key

# Supabase Configuration
NEXT_PUBLIC_SUPABASE_URL=your-supabase-project-url
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-supabase-anon-key

# Google OAuth (Optional)
GOOGLE_CLIENT_ID=your-google-client-id
GOOGLE_CLIENT_SECRET=your-google-client-secret
```

4. **Set up Supabase database**

Run the following SQL commands in your Supabase SQL editor:

```sql
-- Create users table
CREATE TABLE users (
  id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  email text UNIQUE NOT NULL,
  password text,
  name text,
  image text,
  provider text NOT NULL DEFAULT 'credentials' 
    CHECK (provider IN ('credentials', 'google')),
  created_at timestamptz DEFAULT timezone('utc'::text, now()) NOT NULL,
  updated_at timestamptz DEFAULT timezone('utc'::text, now()) NOT NULL
);

-- Create songs table
CREATE TABLE songs (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  title text NOT NULL,
  artist text NOT NULL,
  album text,
  duration integer DEFAULT 0 NOT NULL,
  url text NOT NULL,
  thumbnail text,
  lyrics text,
  uploaded_at timestamptz DEFAULT timezone('utc'::text, now()),
  plays integer DEFAULT 0,
  liked boolean DEFAULT false,
  created_at timestamptz DEFAULT timezone('utc'::text, now()),
  updated_at timestamptz DEFAULT timezone('utc'::text, now()),
  user_id bigint REFERENCES users(id) ON DELETE CASCADE
);

-- Create playlists table
CREATE TABLE playlists (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  name text NOT NULL,
  description text,
  cover_image text,
  created_at timestamptz DEFAULT timezone('utc'::text, now()),
  updated_at timestamptz DEFAULT timezone('utc'::text, now()),
  has_notification boolean DEFAULT false,
  user_id bigint REFERENCES users(id) ON DELETE CASCADE
);

-- Create playlist_songs junction table
CREATE TABLE playlist_songs (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  playlist_id uuid REFERENCES playlists(id) ON DELETE CASCADE NOT NULL,
  song_id uuid REFERENCES songs(id) ON DELETE CASCADE NOT NULL,
  position integer DEFAULT 0 NOT NULL,
  created_at timestamptz DEFAULT timezone('utc'::text, now())
);

-- Create bookmarks table
CREATE TABLE bookmarks (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  song_id uuid REFERENCES songs(id) ON DELETE CASCADE NOT NULL,
  created_at timestamptz DEFAULT timezone('utc'::text, now()),
  user_id bigint REFERENCES users(id) ON DELETE CASCADE
);

-- Create trending tables
CREATE TABLE trending_snapshots (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  period_type text NOT NULL CHECK (period_type IN ('daily', 'weekly', 'monthly')),
  snapshot_date date NOT NULL,
  created_at timestamptz DEFAULT timezone('utc'::text, now()) NOT NULL
);

CREATE TABLE trending_rankings (
  id uuid DEFAULT gen_random_uuid() PRIMARY KEY,
  snapshot_id uuid REFERENCES trending_snapshots(id) ON DELETE CASCADE NOT NULL,
  song_id uuid REFERENCES songs(id) ON DELETE CASCADE NOT NULL,
  ranking integer NOT NULL,
  trending_score numeric NOT NULL,
  plays_count integer NOT NULL,
  play_increase_percent numeric DEFAULT 0,
  created_at timestamptz DEFAULT timezone('utc'::text, now()) NOT NULL
);

-- Create indexes for performance
CREATE INDEX idx_songs_user_id ON songs(user_id);
CREATE INDEX idx_playlists_user_id ON playlists(user_id);
CREATE INDEX idx_bookmarks_user_id ON bookmarks(user_id);
CREATE UNIQUE INDEX idx_bookmarks_user_song ON bookmarks(user_id, song_id);
```

5. **Run the development server**
```bash
npm run dev
# or
yarn dev
# or
pnpm dev
```

Open [http://localhost:3000](http://localhost:3000) to view the application.

## üèó Architecture

### Project Structure
```
src/
‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îú‚îÄ‚îÄ (auth)/            # Authentication pages
‚îÇ   ‚îú‚îÄ‚îÄ (protected)/       # Protected routes
‚îÇ   ‚îú‚îÄ‚îÄ api/               # API routes
‚îÇ   ‚îî‚îÄ‚îÄ globals.css        # Global styles
‚îú‚îÄ‚îÄ components/            # React components
‚îÇ   ‚îú‚îÄ‚îÄ layout/           # Layout components
‚îÇ   ‚îú‚îÄ‚îÄ ui/               # shadcn/ui components
‚îÇ   ‚îî‚îÄ‚îÄ songs/            # Music-related components
‚îú‚îÄ‚îÄ lib/                  # Utility libraries
‚îú‚îÄ‚îÄ hooks/                # Custom React hooks
‚îú‚îÄ‚îÄ types/                # TypeScript type definitions
‚îî‚îÄ‚îÄ middleware.ts         # Next.js middleware
```

### Database Schema
- **users**: User accounts and authentication
- **songs**: Music tracks with metadata
- **playlists**: User-created playlists
- **playlist_songs**: Many-to-many relationship
- **bookmarks**: User's saved songs
- **trending_snapshots**: Trending periods
- **trending_rankings**: Song rankings per period

### Authentication Flow
1. User visits protected route
2. Middleware checks authentication status
3. Unauthenticated users redirected to signin
4. NextAuth.js handles login with email/password or Google OAuth
5. Session stored in JWT tokens
6. API routes validate user sessions

## üö¶ Running the Application

### Development
```bash
npm run dev
```

### Production Build
```bash
npm run build
npm start
```

### Linting
```bash
npm run lint
```

## üîê Authentication & Security

### Authentication Methods
- **Email/Password**: Custom credentials with bcrypt hashing
- **Google OAuth**: Social login integration
- **Session Management**: JWT-based sessions with NextAuth.js

### Security Features
- **Route Protection**: Middleware-based authentication
- **API Security**: User session validation on all protected endpoints
- **Data Isolation**: Users can only access their own data
- **CSRF Protection**: Built-in NextAuth.js security
- **Password Security**: bcrypt hashing with salt rounds

### Protected Routes
- `/` - Main dashboard (requires authentication)
- `/trending` - Trending songs
- `/playlist/*` - Playlist management
- `/api/songs` - Song management APIs
- `/api/playlists` - Playlist APIs
- `/api/bookmarks` - Bookmark APIs

## üìä Supabase Configuration

### Environment Variables
Set up the following in your Supabase project:
```env
NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=your-anon-key
```

### Row Level Security (RLS)
The application uses user_id based data isolation instead of RLS for simplicity. Each user's data is separated by user_id foreign keys.

### Real-time Features
- Live updates for playlist changes
- Real-time trending data
- Instant bookmark synchronization

## üé® UI/UX Features

### Design System
- **Dark/Light Theme**: Automatic theme switching
- **Custom Colors**: oklch color space for better color consistency
- **Typography**: Montserrat font family
- **Responsive**: Mobile-first design approach

### Components
- **Music Player**: Full-featured audio player with waveform
- **Breadcrumb Navigation**: Dynamic route-based navigation
- **Sidebar**: Collapsible navigation with user playlists
- **Modals**: Song addition and playlist creation
- **Toast Notifications**: Success/error feedback

## üîß API Endpoints

### Songs
- `GET /api/songs` - Fetch all songs (public)
- `POST /api/songs` - Add new song (authenticated)
- `GET /api/songs/[id]` - Get specific song
- `PUT /api/songs/[id]` - Update song (owner only)
- `DELETE /api/songs/[id]` - Delete song (owner only)

### Playlists
- `GET /api/playlists` - Get user playlists (authenticated)
- `POST /api/playlists` - Create playlist (authenticated)
- `GET /api/playlists/[id]` - Get specific playlist
- `PUT /api/playlists/[id]` - Update playlist (owner only)
- `DELETE /api/playlists/[id]` - Delete playlist (owner only)

### Bookmarks
- `GET /api/bookmarks` - Get user bookmarks (authenticated)
- `POST /api/bookmarks` - Add bookmark (authenticated)
- `DELETE /api/bookmarks` - Remove bookmark (authenticated)

### Trending
- `GET /api/trending` - Get trending songs
- `GET /api/trending/stats` - Get trending statistics

## üì± Development

### Adding New Features
1. Create components in appropriate directories
2. Add API routes in `src/app/api/`
3. Update database schema if needed
4. Add proper TypeScript types
5. Update middleware for route protection if needed

### State Management
- **Zustand Store**: Global music player state
- **React Query**: Server state and caching
- **React Hook Form**: Form state management

## üöÄ Deployment

### Vercel (Recommended)
1. Connect your repository to Vercel
2. Set environment variables in Vercel dashboard
3. Deploy automatically on push to main branch

### Other Platforms
The app can be deployed on any platform that supports Next.js:
- Netlify
- Railway
- Digital Ocean
- AWS Amplify

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch
3. Commit your changes
4. Push to the branch
5. Open a Pull Request

## üìÑ License

This project is licensed under the MIT License.

## üÜò Support

For support, please open an issue on GitHub or contact the development team.